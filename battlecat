local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local hrp

local Config = {
    DIG = Vector3.new(-10.26,203.11,618.86),
    SELL = Vector3.new(280.97,212.37,603.68),
    DIG_TIME = 3,
    TP_DELAY = 0.5
}

local DigRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("DigRemote")

local State = false
local LoopRunning = false

-- cache HRP
local function getHRP()
    if hrp and hrp.Parent then return hrp end
    local char = player.Character or player.CharacterAdded:Wait()
    hrp = char:WaitForChild("HumanoidRootPart")
    return hrp
end

local function teleport(pos)
    getHRP().CFrame = CFrame.new(pos)
    task.wait(Config.TP_DELAY)
end

local function startLoop()
    if LoopRunning then return end
    LoopRunning = true
    
    task.spawn(function()
        while State do
            teleport(Config.DIG)

            DigRemote:FireServer("RequestStart", Config.DIG)

            local t = os.clock()
            while os.clock() - t < Config.DIG_TIME and State do
                DigRemote:FireServer("Click")
                task.wait()
            end

            teleport(Config.SELL)
            task.wait(1)
        end
        
        LoopRunning = false
    end)
end

-- Toggle
local function toggle()
    State = not State
    if State then
        startLoop()
    end
end
